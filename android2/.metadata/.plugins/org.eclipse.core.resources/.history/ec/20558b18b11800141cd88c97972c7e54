package com.example.hal;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

import android.app.Activity;
import android.bluetooth.BluetoothAdapter;
import android.content.Context;
import android.net.wifi.WifiManager;
import android.telephony.TelephonyManager;
import android.widget.Toast;

public class control_tower extends Activity {

	boolean cam = false;
	boolean mic = false;
	boolean sd = false;
	boolean gps = false;
	boolean mobile_data = false;
	boolean wifi = false;
	boolean bth = false;

	public int control(Context context, String name, boolean bool) {

		toast_print(context, name + " / " + bool);

		if (name=="cam") {

		}
		
		if (name=="wifi") {
			if (0 <= toggleWiFi(context, bool))
				mobile_data = bool;
			else
				toast_print(context, "fail..!");
		}

		if (name=="wifi") {
			if (0 <= toggleWiFi(context, bool))
				wifi = bool;
			else
				toast_print(context, "fail..!");
		}

		if (name=="bth") {
			if (0 <= togglebluetooth(context, bool))
				bth = bool;
			else
				toast_print(context, "fail..!");
		}

		return 0;
	}

	public boolean get_status(){

		return false;
	}

	public int update_status(){

		cam = false;
		mic = false;
		sd = false;
		gps = false;
		mobile_data = false;
		wifi = false;
		bth = false;

		return 0;
	}

	/* WIFI */
	private int toggleWiFi(Context context, boolean status) {
		try {
			WifiManager wifiManager = (WifiManager) context.getSystemService(Context.WIFI_SERVICE);
			if (status == true && !wifiManager.isWifiEnabled()) {
				wifiManager.setWifiEnabled(true);
			} else if (status == false && wifiManager.isWifiEnabled()) {
				wifiManager.setWifiEnabled(false);
			}
			return 0;
		} catch (Exception e) {
			return -1;
		}
	}

	/* bluetooth */
	private int togglebluetooth(Context context, boolean status) {
		try {
			BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter(); 
			if (status == true){
				adapter.enable();
			} else {
				adapter.disable();
			}
			return 0;
		} catch (Exception e) {
			return -1;
		}
	}
	
	private void setMobileDataEnabled(Context context, boolean enabled) throws NoSuchMethodException, IllegalArgumentException, IllegalAccessException, InvocationTargetException, ClassNotFoundException {

		boolean isEnabled;
		Method dataConnSwitchmethod;

		Class telephonyManagerClass;
		Object ITelephonyStub;
		Class ITelephonyClass;

		TelephonyManager telephonyManager = (TelephonyManager) context
				.getSystemService(Context.TELEPHONY_SERVICE);

		if(telephonyManager.getDataState() == TelephonyManager.DATA_CONNECTED){
			isEnabled = true;
		}else{
			isEnabled = false;  
		}   

		telephonyManagerClass = Class.forName(telephonyManager.getClass().getName());
		Method getITelephonyMethod = telephonyManagerClass.getDeclaredMethod("getITelephony");
		getITelephonyMethod.setAccessible(true);
		ITelephonyStub = getITelephonyMethod.invoke(telephonyManager);
		ITelephonyClass = Class.forName(ITelephonyStub.getClass().getName());

		if (isEnabled) {
			dataConnSwitchmethod = ITelephonyClass
					.getDeclaredMethod("disableDataConnectivity");
		} else {
			dataConnSwitchmethod = ITelephonyClass
					.getDeclaredMethod("enableDataConnectivity");   
		}
		dataConnSwitchmethod.setAccessible(true);
		dataConnSwitchmethod.invoke(ITelephonyStub);
	}

	/* toast */
	private void toast_print(Context context, String get_text){
		Toast t = null;
		if(t == null) {
			t = Toast.makeText(context, get_text, Toast.LENGTH_SHORT);
		}
		t.show();
	}

}
